## IMT Order : distributed transactors 

# Overview

This project is a sandbox for simulating an Order Management System (OMS) using mix application. It includes modules for managing orders from ecommerce websites, simulating workflows, and analyzing performance. Its main feature, is the ability to distribute the order management tasks among multiple erlang nodes enabling parallelism of tasks. 

## Features

1. **Hash Ring Distribution**: Dynamically allocate orders to nodes using a consistent hash ring for efficient load balancing.
2. **End-to-End Simulation**: Run comprehensive simulations of e-commerce frontends and warehouse management system (WMS) backends.
3. **Fault Tolerance**: Leverage supervision trees, supervisors, and dynamic supervisors to ensure robustness and system resilience.
4. **API Error Handling**: Implement a retry mechanism to gracefully handle failed HTTP requests and improve reliability.

## Project Structure

1. **`config/`**: Contains configuration files for application settings and environment-specific parameters.
   
2. **`lib/`**: The core source code of the project, organized by functional modules:
   - **`OMS/`**: Handles order management logic.
     - **`OrderDistributor/`**: Implements the consistent hash ring for order distribution.
     - **`Transactor/`**: Manages transaction logic for order processing.
     - **`order_api.ex`**: Core business logic for the order management system (OMS).
   - **`eComFront/`**: Simulates the frontend of the e-commerce platform.
   - **`WMS/`**: Simulates the backend of the warehouse management system (WMS).
   - **`utils/`**: Utility functions for common tasks like error handling and API communication.

3. **`dessins/`**: Stores architectural and functional diagrams for system visualization.
4. **`data/`**: Directory for storing data generated by simulations.
5. **`simulation_analysis.ipynb`**: Jupyter notebook for analyzing simulation results.


# How to run : 

To run the program and observe its different features you can run the following commands : 

## 1. Launch the main simulation: 

First, start the main simulation responsible for distributing the orders to the available nodes. 

    ``` bash
    iex --sname sim-master -S mix
    ```
**`IMPORTANT NOTE`** : Be sure to add the `-master` suffix to the name of the main node. This way, the applications launches the simulation and it will be designated as the main node. 

The simulation will run and you can observe the logs to see the current workflow. 

## 2. Launch additional nodes for load balancing:

Next, you can start other nodes to improve order management. These nodes will be able to start processes to manage workload shared by the master node. 

In a new terminal execute the command : 

    ``` bash
    iex --sname sim-worker -S mix
    ```
**`IMPORTANT NOTE`** : For the workers nodes, you can optionaly specify the suffix "-worker" or the application will fall back to its default impelementaion ( a worker node). 

This command will only launch the `TransactorDynamicSupervisor` to manage received orders from the master node. 

## 3. Connect nodes:

During the main simulation, you can connect the worker nodes to the master node. A log message will be printed in the main terminal, indicating that the master has successfully taken into account the added node. 

In the worker node terminal you can run the following : 

    ``` bash
    iex(without_simulations_node@fl-tp-br-012)1> Node.connect(:"<master-node-name>-master@<host-name>")
    ```
**`IMPORTANT NOTE`** : Remember to change the host name field with the actual name of the machine of the master node as well as the master-node-name field. 

## 4. Removing nodes: 

In the same way we added nodes, we can also remove them. You will notice a log message in the main terminal notifying you of this modification. 

In the worker node terminal you can run the following : 

    ``` bash
    iex(without_simulations_node@fl-tp-br-012)1> Node.disconnect(:"<master-node-name>-master@<host-name>")
    ```
**`IMPORTANT NOTE`** : Remember to change the host name field with the actual name of the machine of the master node as well as the master-node-name field. 



